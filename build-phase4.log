
┌────────────────────────────────────────────────────────────────┐
│ PHASE 0: Environment Verification
│ Time: 2025-10-23 17:32:52
└────────────────────────────────────────────────────────────────┘

ℹ️  Zig compiler check...
ℹ️  Zig version: 0.15.1
ℹ️  Target: wasm32-freestanding
ℹ️  Optimization: -O2
ℹ️  Script directory: /Users/rakis/Downloads/lua-wasm-demo/lua-persistent-demo
✅ Environment verified

┌────────────────────────────────────────────────────────────────┐
│ PHASE 1: Setup
│ Time: 2025-10-23 17:32:52
└────────────────────────────────────────────────────────────────┘

ℹ️  Creating directories...
✅ Directories created
ℹ️  Initializing build log: /Users/rakis/Downloads/lua-wasm-demo/lua-persistent-demo/build.log
✅ Phase 1 complete

┌────────────────────────────────────────────────────────────────┐
│ PHASE 2: Source File Verification
│ Time: 2025-10-23 17:32:52
└────────────────────────────────────────────────────────────────┘

ℹ️  Checking Lua C source files...
✅ All 32 Lua C sources found
ℹ️  Checking Zig source files...
✅ All 8 Zig source files found

┌────────────────────────────────────────────────────────────────┐
│ PHASE 3: Lua C Compilation (wasm32-freestanding)
│ Time: 2025-10-23 17:32:52
└────────────────────────────────────────────────────────────────┘

ℹ️  Compiling 32 Lua C files...
  lapi.c              ✓
  lauxlib.c           ✓
  lbaselib.c          ✓
  lcode.c             ✓
  lcorolib.c          ✓
  lctype.c            ✓
  ldblib.c            ✓
  ldebug.c            ✓
  ldo.c               ✓
  ldump.c             ✓
  lfunc.c             ✓
  lgc.c               ✓
  linit.c             ✓
  liolib.c            ✓
  llex.c              ✓
  lmathlib.c          ✓
  lmem.c              ✓
  loadlib.c           ✓
  lobject.c           ✓
  lopcodes.c          ✓
  loslib.c            ✓
  lparser.c           ✓
  lstate.c            ✓
  lstring.c           ✓
  lstrlib.c           ✓
  ltable.c            ✓
  ltablib.c           ✓
  ltm.c               ✓
  lundump.c           ✓
  lutf8lib.c          ✓
  lvm.c               ✓
  lzio.c              ✓
✅ 32 Lua C files compiled

┌────────────────────────────────────────────────────────────────┐
│ PHASE 4: Zig Compilation & Linking
│ Time: 2025-10-23 17:32:52
└────────────────────────────────────────────────────────────────┘

ℹ️  Building WASM module with Zig...
ℹ️  This includes linking all object files and libc stubs
✅ Zig compilation successful

┌────────────────────────────────────────────────────────────────┐
│ PHASE 5: Output Verification
│ Time: 2025-10-23 17:32:52
└────────────────────────────────────────────────────────────────┘

✅ WASM binary created
ℹ️  Binary size:  1345382 bytes (1313 KB / ~1.28 MB)
ℹ️  Checking WASM magic bytes...
✅ Valid WASM module (magic: 0x0061736d)
ℹ️  Checking file permissions...
✅ WASM binary is executable

┌────────────────────────────────────────────────────────────────┐
│ PHASE 6: Build Summary
│ Time: 2025-10-23 17:32:52
└────────────────────────────────────────────────────────────────┘

BUILD ARTIFACTS:
  Output Directory:     /Users/rakis/Downloads/lua-wasm-demo/lua-persistent-demo/web
  WASM Binary:          /Users/rakis/Downloads/lua-wasm-demo/lua-persistent-demo/web/lua.wasm
  Object Files:         /Users/rakis/Downloads/lua-wasm-demo/lua-persistent-demo/.build/*.o
  Build Log:            /Users/rakis/Downloads/lua-wasm-demo/lua-persistent-demo/build.log

BINARY INFORMATION:
  Size:                  1345382 bytes
  Size (KB):            1313 KB
  Target:               wasm32-freestanding
  Optimization:         -O2

STATISTICS:
  Lua C files compiled: 32
  Object files created: 32
  Total time:           1761255173 - see log

EXPORT INFORMATION:
  The following functions are exported to JavaScript:
    • init()              - Initialize Lua state
    • compute()           - Execute Lua code
    • get_buffer_ptr()    - Get I/O buffer pointer
    • get_buffer_size()   - Get I/O buffer size (64KB)
    • get_memory_stats()  - Get memory usage information
    • run_gc()            - Trigger garbage collection

NEXT STEPS:
  1. Test in web browser:
     cd web && python3 -m http.server 8000
     open http://localhost:8000

  2. Verify exports with Node.js:
     node check_exports.js

  3. Compare with WASI build:
     ./build.sh  # (existing WASI-based build)


┌────────────────────────────────────────────────────────────────┐
│ PHASE 7: Build Comparison
│ Time: 2025-10-23 17:32:52
└────────────────────────────────────────────────────────────────┘


╔════════════════════════════════════════════════════════════════╗
║                   ✅ BUILD SUCCESSFUL                          ║
║                                                                ║
║  WASM Module:        web/lua.wasm                              ║
║  Size:               1313 KB                                ║
║  Target:             wasm32-freestanding                        ║
╚════════════════════════════════════════════════════════════════╝

